---
title: "系统设计 101"
date: 2019-07-21T00:10:14+08:00
weight: 5
---

求职系列文章：

- [如何准备技术面试](../面试准备/)
- [如何写一份更好的简历](../如何写一份更好的简历/)
- [程序员国外求职指南](../程序员国外求职指南/)


在没进行过系统设计面试之前，我猜想系统设计问的问题一定非常难而且详细，例如谈到用 Nginx 做负载均衡的话，要回答它使用什么模型来处理请求，以及什么情况下会失效。但是经过多次的面试，以及阅读大量的教程以及视频后，我发现解决系统设计，对于有一定项目经验的人来说，流程往往比细节更重要，只要把主要功能点与框架理清楚，再就自己熟悉的方向深入作答，就能得到不错的评价。这篇文章并不是教你如何设计一套高可用的系统，而是让你能发挥出自己真实的架构能力。总体可以分成六个部分：

1. 多问问题
2. 列出功能点
3. 列出每秒请求数以及数据存储量
4. 系统架构
5. 分析瓶颈
6. 架构优化

#### 多问问题
通常一开始我们得到的要求都是比较简单的一句话：

> “如何设计像uber这样的应用？”

> “如何设计像Twitter这样的应用？”

> “如何设计一个分布式日志系统？”

这是命题者故意的，因为我们在现实解决问题的时候都从一个粗略的命题开始，然后一步步细化一步步分析，如何提出好的问题，找到解决问题的方案就是系统设计的第一个考点。花费一些时间去问问题非常重要，问题要问出要求的功能点以及系统的要求，例如：

> “uber包括很多功能，例如用户叫车，派单给司机，路径显示，支付，评价等等。我要实现的是哪几个功能？”

要知道，面试官并不期待你可以在一小时内把uber全部功能的架构设计出来，通常会关注某些特定的功能点。在这里，可能是叫车，派单，路径显示这几个功能。那么之后我们就可以着重在这几个功能点。

> “每秒请求数知道吗？我们对服务器数量，API 响应时间，存储可用性有什么要求？”

运气好的话，面试官会告诉叫车模块每秒可能1000个请求，运气不好的话，面试官只会告诉你每天有多少有请求，然后我们自己计算。

> “每天有100万名用户使用我们的叫车系统。”

一些基础的数据可以帮助我们计算：

一天有86400秒

80%的请求出现在20%的时间，也就是说5小时18000秒中包含了80万个请求，平均 44 res/s。我们假设峰值为100 res/s，100 res/s 是什么水平呢？一般来说，一台普通服务器，100名用户并发的时候，处理 html 纯静态文件，响应可以达到 7000 res/s，处理简单的动态请求（不考虑数据库花费的时间），响应数可以达到 400 res/s，如果访问数据库的话，可能会降至 50 res/s，不过其中涉及了非常多的细节。总体来说，你可以先问每台服务器的能接受


“日志系统的存储可用性达到99.99%，或者刷新 Twitter 的时候响应时间要在200ms以内，核心点每秒请求数，数据每秒写入数或者只能使用20台服务器。理清楚这些要点对以后的优化非常有帮助。这些都需要在白板上记录下来。

![白板]()


